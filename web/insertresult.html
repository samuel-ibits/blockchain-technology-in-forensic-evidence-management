<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.4-rc.1/web3.min.js"></script>
    
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Insert Report</title>
    <link rel="stylesheet" href="insertresult.css" />
  </head>
  <body>
    <div class="top-section">
      <img src="images/logo.png" alt="" srcset="" />
    </div>
    <div class="pc-logo">
      <div class="pc-logo-img">
        <img src="./images/pc-logo.png" alt="" />
      </div>
    </div>
    <div class="flexed">
      <div class="wide-mobile">
        <form id="upload-form" enctype="multipart/form-data">
          <div id="upload-container" class="container">
            <input type="file" name="file" required id="image-upload" accept="image/*" />
          </div>

          <button type="submit" class="login-button" id="upload-button" onclick="connect()">Upload</button>
        </form>
      </div>
    </div>
<script>
/* To connect using MetaMask */
  async function connect() {

    

    if (window.ethereum) {
      await window.ethereum.request({ method: "eth_requestAccounts" });
      window.web3 = new Web3(window.ethereum);
      const account = web3.eth.accounts;
      //Get the current MetaMask selected/active wallet
      const walletAddress = account.givenProvider.selectedAddress;

      const publicKey = await web3.eth.getPublicKey(accounts[0]);

      console.log('Public Key:', publicKey);
      console.log(`Wallet: ${walletAddress}`);

    } else {
      console.log("No wallet");
    }
  // Prepare the form data
    const formData = new FormData();
    formData.append("file", form.elements.file.files[0]);
    formData.append("walletAddress", walletAddress);
    formData.append("privateKey", walletAddress);

    // Send the form data to your server
    const response = await fetch("http://localhost:3000/upload", {
      method: "POST",
      body: formData
    });
 
 }
</script>
  </body>
</html>